<div class="service-detail-container" *ngIf="provider && !isLoading; else loading">
  <!-- Header / Hero Section -->
  <div class="service-hero">
    <div class="hero-left">
      <img *ngIf="provider.logoUrl"
           class="provider-logo"
           [src]="provider.logoUrl.startsWith('/uploads') ? environment.uploadsUrl + provider.logoUrl : provider.logoUrl"
           [alt]="provider.businessName + ' Logo'"
           (error)="provider.logoUrl = 'assets/default.png'" />
    </div>

    <div class="hero-info">
      <h1>{{ provider.businessName }}</h1>
      <span *ngIf="provider.isVerified" class="verified-badge">
        <mat-icon>verified</mat-icon> Verified
      </span>
      <p class="category">{{ provider.category }}</p>
    </div>
  </div>

  <!-- Service Description -->
  <div class="service-body">
    <div class="service-info-card">
      <h2>{{ provider.title }}</h2>
      <p class="description">{{ provider.description }}</p>

      <div class="service-meta">
        <p>
          <mat-icon>schedule</mat-icon>
          Duration: {{ provider.durationMinutes }} mins
        </p>
        <p>
          <mat-icon>attach_money</mat-icon>
          Price: {{ provider.price | currency:'ZAR' }}
        </p>
        <p *ngIf="provider.businessLocation">
          <mat-icon>location_on</mat-icon>
          {{ provider.businessLocation }}
        </p>
      </div>

      <button class="book-btn" (click)="openBookingDialog(provider.id)">
        <mat-icon>calendar_today</mat-icon> Book Now
      </button>
    </div>

    <!-- Gallery -->
    <div class="gallery" *ngIf="provider.imageUrl">
      <img [src]="provider.imageUrl.startsWith('/uploads') ? environment.uploadsUrl + provider.imageUrl : provider.imageUrl"
           alt="Service image"
           (error)="provider.imageUrl = 'assets/default.png'" />
    </div>
  </div>

  <!-- Reviews Section -->
  <div class="reviews-section">
    <h3>Customer Reviews</h3>

    <div *ngIf="reviews.length > 0; else noReviews">
      <div class="review-card" *ngFor="let review of reviews">
        <div class="review-header">
          <strong>{{ review.customerName }}</strong>
          <span class="rating">
            <mat-icon *ngFor="let i of [].constructor(review.rating)">star</mat-icon>
          </span>
        </div>
        <p class="comment">{{ review.comment }}</p>
      </div>
    </div>

    <ng-template #noReviews>
      <p class="no-reviews">No reviews yet for this provider.</p>
    </ng-template>
  </div>
</div>

<ng-template #loading>
  <div class="loading-container">
    <mat-spinner></mat-spinner>
    <p>Loading service details...</p>
  </div>
</ng-template>
