<div class="promotion-container">
  <div class="header">
    <h2>Promotions</h2>
    <button class="create-promo-btn" (click)="openCreatePromoModal()">Create Promotion</button>
  </div>

  <!-- Create Promotion Form -->
  <div *ngIf="showCreateForm" class="create-form">
    <h3>Create New Promotion</h3>
    <form (submit)="submitPromotion()">
      <label>Title</label>
      <input type="text" [(ngModel)]="formData.title" name="title" required />

      <label>Description</label>
      <textarea [(ngModel)]="formData.description" name="description" required></textarea>

      <label>Category</label>
      <input type="text" [(ngModel)]="formData.category" name="category" required />

      <label>Expires At</label>
      <input type="date" [(ngModel)]="formData.expiresAt" name="expiresAt" required />

      <label>Images</label>
      <input type="file" (change)="onFilesSelected($event)" multiple />

      <div class="form-actions">
        <button type="submit">Submit</button>
        <button type="button" (click)="cancelCreate()">Cancel</button>
      </div>
    </form>
  </div>

  <!-- Search + Filter -->
  <div class="filter-bar">
    <input type="text"
           placeholder="Search promotions..."
           [(ngModel)]="searchTerm" />

    <select [(ngModel)]="filterCategory">
      <option value="">All Categories</option>
      <option *ngFor="let cat of uniqueCategories" [value]="cat">{{ cat }}</option>
    </select>

    <select [(ngModel)]="sortBy">
      <option value="expiresAt">Sort by Expiry</option>
      <option value="title">Sort by Title</option>
      <option value="postedBy">Sort by Poster</option>
    </select>
  </div>

  <!-- Promotion Cards -->
  <div class="promotions-grid">
    <div *ngFor="let promo of filteredPromotions" class="promo-card">
      <img *ngIf="getPromotionImageUrl(promo)"
           [src]="getPromotionImageUrl(promo)"
           alt="{{ promo.title }}" />

      <div class="promo-content">
        <h3>{{ promo.title }}</h3>
        <p>{{ promo.description }}</p>
        <span>Category: {{ promo.category }}</span>
        <br />
        <span>By {{ promo.postedBy || 'Anonymous' }}</span>
        <br />
        <span>{{ promo.expiresAt | date: 'mediumDate' }}</span>
      </div>
    </div>
  </div>
</div>
