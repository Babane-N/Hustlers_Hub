<div class="promo-container">
  <h2>Promotions</h2>
  <p class="subtitle">Discover the latest deals, offers, and highlights from our service providers.</p>

  <div class="search-sort-filter">
    <input type="text"
           placeholder="Search promotions..."
           [(ngModel)]="searchTerm" />

    <select [(ngModel)]="selectedCategory">
      <option value="">All Categories</option>
      <option value="Services">Services</option>
      <option value="Events">Events</option>
      <option value="Products">Products</option>
      <option value="Other">Other</option>
    </select>

    <select [(ngModel)]="sortOrder">
      <option value="">Sort by</option>
      <option value="newest">Newest First</option>
      <option value="oldest">Oldest First</option>
    </select>
  </div>

  <div *ngIf="isLoading" class="text-center">Loading promotions...</div>

  <div class="promo-list" *ngIf="!isLoading && filteredPromotions().length > 0">
    <div class="promo-card" *ngFor="let promo of filteredPromotions()">
      <!-- main image -->
      <ng-container *ngIf="(promo.images ?? []).length > 0; else noImage">
        <img [src]="promo.images![0]"
             alt="{{ promo.title }} Image"
             class="promo-main-img"
             (error)="handleImageError(promo, promo.images![0])" />
      </ng-container>

      <ng-template #noImage>
        <div class="promo-placeholder">
          No image available
        </div>
      </ng-template>

      <h3>{{ promo.title }}</h3>
      <p>{{ promo.description }}</p>

      <div class="promo-meta">
        <span>{{ promo.category }}</span>
        <span>{{ promo.createdAt | date: 'mediumDate' }}</span>
      </div>

      <div class="promo-images" *ngIf="(promo.images ?? []).length > 1">
        <img *ngFor="let img of promo.images!.slice(1)"
             [src]="img"
             alt="{{ promo.title }} Image"
             class="promo-img"
             (error)="handleImageError(promo, img)" />
      </div>
    </div>
  </div>

  <div *ngIf="!isLoading && filteredPromotions().length === 0" class="text-center">
    No promotions found.
  </div>
</div>

